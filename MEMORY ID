程序 ZHRR300
DATA:MEM_ID TYPE C.
END-OF-SELECTION.


  IF 02P02 = 'X'.

    CONCATENATE 'ZHRR300-HZ'  SY-DATUM INTO MEM_ID.
    FREE MEMORY ID MEM_ID.
    LOOP AT T_ITAB.
      MOVE-CORRESPONDING T_ITAB TO GT_ITAB1.
      APPEND GT_ITAB1.CLEAR GT_ITAB1.
    ENDLOOP.
    EXPORT  TABLE1   =  GT_ITAB1

     TO MEMORY ID MEM_ID.
  ELSE.
    PERFORM DISPLAY_ALV. "ALV 数据展示         后期加的 他的from在from里
  ENDIF.
  
  ------------RFC
  DATA:MEM_ID TYPE C.

  CONCATENATE 'ZHRR301-MX' SY-DATUM INTO MEM_ID.
  IF I_PERNR NE 0.
    SUBMIT ZHRR301 USING SELECTION-SCREEN '1000'
              WITH P_OBJID = I_OBJID
              WITH P_BEGDA = I_BEGDA
              WITH P_ENDDA = I_ENDDA
              WITH PNPPERNR-LOW = I_PERNR

              WITH 02P02 = 'X'
              WITH 01P02 = ' '

              AND RETURN.
  ELSE.
    SUBMIT ZHRR301 USING SELECTION-SCREEN '1000'
      WITH P_OBJID = I_OBJID
      WITH P_BEGDA = I_BEGDA
      WITH P_ENDDA = I_ENDDA
*           WITH PNPPERNR-LOW = I_PERNR

      WITH 02P02 = 'X'
      WITH 01P02 = ' '

      AND RETURN.
  ENDIF.


  IMPORT  TABLE1  = OT_KQMX[] FROM MEMORY ID MEM_ID.
  IF I_PERNR IS NOT INITIAL.
    DELETE OT_KQMX WHERE PERNR NE I_PERNR.
  ENDIF.
